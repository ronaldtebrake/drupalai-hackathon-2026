uuid: 258a506d-8181-4c5c-ba53-43d857007fe7
langcode: en
status: true
dependencies: {  }
id: entity_save
label: 'entity save'
description: ''
nodes:
  -
    id: trigger.1
    type: universalNode
    position:
      x: -210
      'y': 160
    data:
      label: Trigger
      config:
        nodeType: default
        instanceTitle: ''
        instanceDescription: ''
      metadata:
        id: trigger
        name: Trigger
        type: terminal
        supportedTypes:
          - default
          - simple
          - terminal
        description: 'Start workflow on events (entity changes, user actions, form submissions, cron, etc.)'
        category: inputs
        icon: 'mdi:flash-outline'
        color: '#10b981'
        plugin_version: 2.2.0
        enabled: true
        tags: {  }
        executor_plugin: 'flowdrop_trigger:trigger'
        inputs:
          -
            id: trigger
            name: Trigger
            type: input
            dataType: trigger
            required: false
            description: ''
        outputs:
          -
            id: data
            name: 'Event Data'
            type: output
            dataType: json
            required: false
            description: 'Complete trigger data. Contains event_type, timestamp, and event-specific properties.'
          -
            id: user
            name: 'User Data'
            type: output
            dataType: json
            required: false
            description: 'User entity data (user.* events only)'
          -
            id: form
            name: Form
            type: output
            dataType: json
            required: false
            description: 'Form structure (form.* events only)'
          -
            id: form_values
            name: 'Form Values'
            type: output
            dataType: json
            required: false
            description: 'Submitted form values (form.* events only)'
          -
            id: form_id
            name: 'Form ID'
            type: output
            dataType: string
            required: false
            description: 'The form ID (form.* events only)'
          -
            id: form_state
            name: 'Form State'
            type: output
            dataType: json
            required: false
            description: 'Form state (form.* events only)'
          -
            id: cron
            name: 'Cron Data'
            type: output
            dataType: json
            required: false
            description: 'Cron execution info (cron.* events only)'
          -
            id: trigger
            name: Trigger
            type: output
            dataType: trigger
            required: false
            description: 'Emitted when this node completes execution'
        config:
          type: terminal
        configSchema:
          type: object
          properties:
            nodeType:
              type: string
              title: 'Visual Type'
              description: 'Select the visual appearance for this node instance.'
              enum:
                - default
                - simple
                - terminal
              default: terminal
            instanceTitle:
              type: string
              title: Title
              description: 'Override the default node title for this instance.'
              x-display-order: -2
            instanceDescription:
              type: string
              title: Description
              description: 'Override the default description for this instance.'
              format: multiline
              x-display-order: -1
          required: {  }
        configEdit:
          dynamicSchema:
            url: /api/flowdrop/triggers/schema
            method: GET
            parameterMapping:
              event_type: config.event_type
            headers: {  }
            cacheSchema: false
            timeout: 10000
          externalEditLink:
            url: '/admin/flowdrop/triggers/configure?workflow={workflowId}&node={nodeId}'
            label: 'Configure Trigger'
            icon: 'mdi:flash-outline'
            description: 'Open trigger configuration form in admin interface'
            parameterMapping:
              workflowId: workflowId
              nodeId: id
            openInNewTab: true
          api:
            create: /api/flowdrop/triggers
            read: '/api/flowdrop/triggers/{trigger_config_id}'
            update: '/api/flowdrop/triggers/{trigger_config_id}'
            delete: '/api/flowdrop/triggers/{trigger_config_id}'
            eventTypes: /api/flowdrop/triggers/event-types
          preferDynamicSchema: false
          showRefreshButton: true
          loadingMessage: 'Loading trigger configuration...'
          errorMessage: 'Failed to load trigger configuration'
      nodeId: trigger.1
      extensions:
        ui:
          hideUnconnectedHandles: false
    deletable: true
    measured:
      width: 288
      height: 815
    selected: false
    dragging: false
  -
    id: misstraal_ai_contexts_guideline_scoring.3
    type: universalNode
    position:
      x: 310
      'y': 260
    data:
      label: 'Guideline Scoring'
      config: {  }
      metadata:
        id: misstraal_ai_contexts_guideline_scoring
        name: 'Guideline Scoring'
        type: default
        supportedTypes:
          - default
        description: 'Builds prompts from ai_context pools and scores content in two categories (AI and Editorial)'
        category: processing
        icon: 'mdi:cog'
        color: '#14b8a6'
        plugin_version: 1.0.0
        enabled: true
        tags: {  }
        executor_plugin: 'misstraal_ai_contexts:guideline_scoring'
        inputs:
          -
            id: content
            name: Content
            type: input
            dataType: mixed
            required: false
            description: 'The content to be scored (can be string or entity data array)'
          -
            id: data
            name: Data
            type: input
            dataType: mixed
            required: false
            description: 'Data from trigger or other nodes'
          -
            id: input
            name: Input
            type: input
            dataType: mixed
            required: false
            description: 'Input from any previous node (unified input port)'
          -
            id: response
            name: Response
            type: input
            dataType: string
            required: false
            description: 'Response from a previous node (e.g., ChatModel response output)'
          -
            id: raw_response
            name: 'Raw Response'
            type: input
            dataType: string
            required: false
            description: 'Raw response from a previous node (e.g., ChatModel raw_response output)'
          -
            id: trigger
            name: Trigger
            type: input
            dataType: trigger
            required: false
            description: ''
        outputs:
          -
            id: prompt
            name: Prompt
            type: output
            dataType: string
            required: false
            description: 'The built prompt with guidelines and content for scoring evaluation'
          -
            id: trigger
            name: Trigger
            type: output
            dataType: trigger
            required: false
            description: 'Emitted when this node completes execution'
        config: {  }
        configSchema:
          type: object
          properties:
            content:
              type: mixed
              title: Content
              description: 'The content to be scored (can be string or entity data array)'
              required: false
            data:
              type: mixed
              title: Data
              description: 'Data from trigger or other nodes'
              required: false
            input:
              type: mixed
              title: Input
              description: 'Input from any previous node (unified input port)'
              required: false
            response:
              type: string
              title: Response
              description: 'Response from a previous node (e.g., ChatModel response output)'
              required: false
            raw_response:
              type: string
              title: 'Raw Response'
              description: 'Raw response from a previous node (e.g., ChatModel raw_response output)'
              required: false
            instanceTitle:
              type: string
              title: Title
              description: 'Override the default node title for this instance.'
              x-display-order: -2
            instanceDescription:
              type: string
              title: Description
              description: 'Override the default description for this instance.'
              format: multiline
              x-display-order: -1
          required: {  }
      nodeId: misstraal_ai_contexts_guideline_scoring.3
    deletable: true
    measured:
      width: 288
      height: 740
    selected: false
    dragging: false
  -
    id: misstraal_ai_contexts_chat_model.1
    type: universalNode
    position:
      x: 910
      'y': 140
    data:
      label: 'Chat Model'
      config:
        system_message: ''
        model: ''
        temperature: 0.7
        response_format: ''
        nodeType: default
      metadata:
        id: misstraal_ai_contexts_chat_model
        name: 'Chat Model'
        type: default
        supportedTypes:
          - default
          - gateway
          - note
          - idea
          - simple
          - square
          - tool
          - terminal
        description: 'Calls AI chat models using the Drupal AI module'
        category: processing
        icon: 'mdi:cog'
        color: '#14b8a6'
        plugin_version: 1.0.0
        enabled: true
        tags: {  }
        executor_plugin: 'misstraal_ai_contexts:chat_model'
        inputs:
          -
            id: prompt
            name: Prompt
            type: input
            dataType: string
            required: false
            description: 'The input prompt to send to the AI model'
          -
            id: system_message
            name: 'System Message'
            type: input
            dataType: string
            required: false
            description: 'Optional system message to set context for the AI'
            defaultValue: ''
          -
            id: model
            name: Model
            type: input
            dataType: string
            required: false
            description: 'Optional model identifier (uses default if not specified)'
            defaultValue: ''
          -
            id: temperature
            name: Temperature
            type: input
            dataType: number
            required: false
            description: 'Sampling temperature (0.0 to 2.0)'
            defaultValue: '0.7'
          -
            id: response_format
            name: 'Response Format'
            type: input
            dataType: string
            required: false
            description: 'Response format (e.g., "json_object" for structured JSON)'
            defaultValue: ''
          -
            id: trigger
            name: Trigger
            type: input
            dataType: trigger
            required: false
            description: ''
        outputs:
          -
            id: response
            name: Response
            type: output
            dataType: string
            required: false
            description: 'The AI model response text'
          -
            id: raw_response
            name: 'Raw Response'
            type: output
            dataType: string
            required: false
            description: 'The raw response from the AI model'
          -
            id: model
            name: Model
            type: output
            dataType: string
            required: false
            description: 'The model identifier that was used'
          -
            id: trigger
            name: Trigger
            type: output
            dataType: trigger
            required: false
            description: 'Emitted when this node completes execution'
        config:
          system_message: ''
          model: ''
          temperature: 0.7
          response_format: json_object
          type: default
        configSchema:
          type: object
          properties:
            prompt:
              type: string
              title: Prompt
              description: 'The input prompt to send to the AI model'
              required: true
            system_message:
              type: string
              title: 'System Message'
              description: 'Optional system message to set context for the AI'
              default: ''
            model:
              type: string
              title: Model
              description: 'Optional model identifier (uses default if not specified)'
              default: ''
            temperature:
              type: number
              title: Temperature
              description: 'Sampling temperature (0.0 to 2.0)'
              default: 0.7
              minimum: 0
              maximum: 2
            response_format:
              type: string
              title: 'Response Format'
              description: 'Response format (e.g., "json_object" for structured JSON)'
              default: ''
              enum:
                - ''
                - json_object
            nodeType:
              type: string
              title: 'Visual Type'
              description: 'Select the visual appearance for this node instance.'
              enum:
                - default
                - gateway
                - note
                - idea
                - simple
                - square
                - tool
                - terminal
              default: default
            instanceTitle:
              type: string
              title: Title
              description: 'Override the default node title for this instance.'
              x-display-order: -2
            instanceDescription:
              type: string
              title: Description
              description: 'Override the default description for this instance.'
              format: multiline
              x-display-order: -1
          required: {  }
      nodeId: misstraal_ai_contexts_chat_model.1
    deletable: true
    measured:
      width: 288
      height: 890
    selected: false
    dragging: false
  -
    id: misstraal_ai_contexts_guideline_score_parser.1
    type: universalNode
    position:
      x: 1410
      'y': 250
    data:
      label: 'Guideline Score Parser'
      config: {  }
      metadata:
        id: misstraal_ai_contexts_guideline_score_parser
        name: 'Guideline Score Parser'
        type: default
        supportedTypes:
          - default
        description: 'Parses JSON response from guideline scoring and extracts scores and reasoning'
        category: processing
        icon: 'mdi:cog'
        color: '#14b8a6'
        plugin_version: 1.0.0
        enabled: true
        tags: {  }
        executor_plugin: 'misstraal_ai_contexts:guideline_score_parser'
        inputs:
          -
            id: response
            name: Response
            type: input
            dataType: string
            required: false
            description: 'Response from ChatModelNode'
          -
            id: input
            name: Input
            type: input
            dataType: mixed
            required: false
            description: 'Input from any previous node (unified input port)'
          -
            id: trigger
            name: Trigger
            type: input
            dataType: trigger
            required: false
            description: ''
        outputs:
          -
            id: ai_score
            name: 'AI Score'
            type: output
            dataType: number
            required: false
            description: 'Score for AI/LLM optimization category (0-100)'
          -
            id: ai_reasoning
            name: 'AI Reasoning'
            type: output
            dataType: string
            required: false
            description: 'Reasoning for the AI score'
          -
            id: editorial_score
            name: 'Editorial Score'
            type: output
            dataType: string
            required: false
            description: 'Score for editorial/style category (0-100)'
          -
            id: editorial_reasoning
            name: 'Editorial Reasoning'
            type: output
            dataType: string
            required: false
            description: 'Reasoning for the editorial score'
          -
            id: raw_response
            name: 'Raw Response'
            type: output
            dataType: string
            required: false
            description: 'The cleaned JSON response'
          -
            id: trigger
            name: Trigger
            type: output
            dataType: trigger
            required: false
            description: 'Emitted when this node completes execution'
        config: {  }
        configSchema:
          type: object
          properties:
            response:
              type: string
              title: Response
              description: 'Response from ChatModelNode'
              required: false
            input:
              type: mixed
              title: Input
              description: 'Input from any previous node (unified input port)'
              required: false
            instanceTitle:
              type: string
              title: Title
              description: 'Override the default node title for this instance.'
              x-display-order: -2
            instanceDescription:
              type: string
              title: Description
              description: 'Override the default description for this instance.'
              format: multiline
              x-display-order: -1
          required: {  }
      nodeId: misstraal_ai_contexts_guideline_score_parser.1
    deletable: true
    measured:
      width: 288
      height: 815
    selected: false
    dragging: false
edges:
  -
    id: xy-edge__trigger.1trigger.1-output-data-misstraal_ai_contexts_guideline_scoring.3misstraal_ai_contexts_guideline_scoring.3-input-data
    source: trigger.1
    target: misstraal_ai_contexts_guideline_scoring.3
    data:
      targetNodeType: universalNode
      targetCategory: processing
      metadata:
        edgeType: data
        sourcePortDataType: json
    sourceHandle: trigger.1-output-data
    targetHandle: misstraal_ai_contexts_guideline_scoring.3-input-data
    style: 'stroke: var(--flowdrop-edge-data-color);'
    markerEnd:
      type: arrowclosed
      width: 16
      height: 16
      color: '#9ca3af'
    class: flowdrop--edge--data
  -
    id: xy-edge__misstraal_ai_contexts_guideline_scoring.3misstraal_ai_contexts_guideline_scoring.3-output-prompt-misstraal_ai_contexts_chat_model.1misstraal_ai_contexts_chat_model.1-input-prompt
    source: misstraal_ai_contexts_guideline_scoring.3
    target: misstraal_ai_contexts_chat_model.1
    data:
      targetNodeType: universalNode
      targetCategory: processing
      metadata:
        edgeType: data
        sourcePortDataType: string
    sourceHandle: misstraal_ai_contexts_guideline_scoring.3-output-prompt
    targetHandle: misstraal_ai_contexts_chat_model.1-input-prompt
    style: 'stroke: var(--flowdrop-edge-data-color);'
    markerEnd:
      type: arrowclosed
      width: 16
      height: 16
      color: '#9ca3af'
    class: flowdrop--edge--data
  -
    id: xy-edge__misstraal_ai_contexts_chat_model.1misstraal_ai_contexts_chat_model.1-output-response-misstraal_ai_contexts_guideline_score_parser.1misstraal_ai_contexts_guideline_score_parser.1-input-response
    source: misstraal_ai_contexts_chat_model.1
    target: misstraal_ai_contexts_guideline_score_parser.1
    data:
      targetNodeType: universalNode
      targetCategory: processing
      metadata:
        edgeType: data
        sourcePortDataType: string
    sourceHandle: misstraal_ai_contexts_chat_model.1-output-response
    targetHandle: misstraal_ai_contexts_guideline_score_parser.1-input-response
    style: 'stroke: var(--flowdrop-edge-data-color);'
    markerEnd:
      type: arrowclosed
      width: 16
      height: 16
      color: '#9ca3af'
    class: flowdrop--edge--data
metadata:
  version: 1.0.0
  createdAt: '2026-01-27T15:34:49.378Z'
  updatedAt: '2026-01-28T07:00:50.499Z'
created: 1769528027
changed: 1769583650
uid: 0
